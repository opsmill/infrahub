Save a diff in smaller pieces instead of all at once to prevent out-of-memory error.