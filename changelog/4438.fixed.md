Updates internal logic to improve performance when generating a diff.

BREAKING CHANGE: Diff data, including conflict selections, will be deleted. We recommend merging
any outstanding proposed changes before upgrading to this version.