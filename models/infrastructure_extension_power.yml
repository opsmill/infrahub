# yaml-language-server: $schema=https://schema.infrahub.app/develop/schema.schema.json
---
version: '1.0'
generics:
  - name: Power
    namespace: Infra
    description: "Generic Power."
    label: "Power"
    display_labels:
      - name__value
    order_by:
      - name__value
    attributes:
      - name: name
        kind: Text
      - name: description
        kind: Text
        optional: true
      - name: enabled
        kind: Boolean
        default_value: true
    relationships:
      - name: status
        peer: BuiltinStatus
        optional: false
        cardinality: one
        kind: Attribute
      - name: role
        peer: BuiltinRole
        optional: true
        cardinality: one
        kind: Attribute
      - name: device
        peer: InfraDevice
        identifier: "device__power"
        optional: false
        cardinality: one
        kind: Parent
      - name: tags
        peer: BuiltinTag
        optional: true
        cardinality: many
        kind: Attribute
      - name: connected_endpoint
        peer: InfraPower
        optional: true
        cardinality: one
        kind: Attribute
        identifier: connected__power
  - name: Choice
    namespace: Template
    description: "Generic Choice"
    label: "Choice"
    display_labels:
      - name__value
    order_by:
      - name__value
    attributes:
      - name: name
        kind: Text
        unique: true
      - name: description
        kind: Text
        optional: true
      - name: Color
        kind: Text
        optional: true
    relationships:
      - name: tags
        peer: BuiltinTag
        optional: true
        cardinality: many
        kind: Attribute
nodes:
  - name: Device
    namespace: Infra
    description: "Generic Device object."
    label: "Device"
    default_filter: name__value
    inherit_from:
      - "CoreArtifactTarget"
    order_by:
      - name__value
    display_labels:
      - name__value
    attributes:
      - name: name
        kind: Text
      - name: description
        kind: Text
        optional: true
      - name: serial_number
        label: Serial Number
        kind: Text
        optional: true
      - name: asset_tag
        label: Asset Tag
        kind: Text
        optional: true
        unique: true
    relationships:
      - name: site
        peer: BuiltinLocation
        optional: false
        cardinality: one
        kind: Attribute
      - name: status
        peer: BuiltinStatus
        optional: false
        cardinality: one
        kind: Attribute
      - name: role
        peer: BuiltinRole
        optional: true
        cardinality: one
        kind: Attribute
      - name: power
        label: "Power Outlet & Ports"
        peer: InfraPower
        identifier: "device__power"
        optional: true
        cardinality: many
        kind: Component
      - name: tags
        peer: BuiltinTag
        optional: true
        cardinality: many
        kind: Attribute
  - name: PowerOutlet
    namespace: Infra
    description: "Power Outlet"
    label: "Power Outlet"
    display_labels:
      - name__value
    order_by:
      - name__value
    inherit_from:
      - "InfraPower"
    attributes:
      - name: feed
        label: Feed
        optional: true
        kind: Text
    relationships:
      - name: port_type
        label: Type
        identifier: poweroutlet__type
        peer: TemplatePowerOutletType
        optional: false
        cardinality: one
  - name: PowerPort
    namespace: Infra
    description: "Power Port"
    label: "Power Port"
    display_labels:
      - name__value
    order_by:
      - name__value
    inherit_from:
      - "InfraPower"
    attributes:
      - name: alloc_draw
        label: Allocated Draw
        kind: Number
      - name: max_draw
        label: Maximun Draw
        kind: Number
    relationships:
      - name: port_type
        label: Type
        identifier: powerport__type
        peer: TemplatePowerPortType
        optional: false
        cardinality: one
  - name: PowerOutletType
    namespace: Template
    description: "Power Outlet Type"
    label: "Power Outlet Type"
    display_labels:
      - name__value
    order_by:
      - name__value
    inherit_from:
      - "TemplateChoice"
    relationships:
      - cardinality: many
        identifier: poweroutlet__type
        name: PowerOutlet
        optional: true
        peer: InfraPowerOutlet
  - name: PowerPortType
    namespace: Template
    description: "Power Port Type"
    label: "Power Port Type"
    display_labels:
      - name__value
    order_by:
      - name__value
    inherit_from:
      - "TemplateChoice"
    relationships:
      - cardinality: many
        identifier: powerport__type
        name: PowerPort
        optional: true
        peer: InfraPowerPort
